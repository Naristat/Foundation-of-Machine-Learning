<!DOCTYPE html>
<html lang="en">
  </div>
        <nav class="nav">
                    <a href="https://surnamnarendra.github.io/Fundamentals-of-Machine-Learning/" aria-current="page">Home</a>
          <a href="lecture_17.html" aria-current="page">L21</a>
          <a href="lecture_18.html">L22</a>
          <a href="lecture_19.html">L23</a>
          <a href="lecture_20.html">L24</a>
              <a href="lecture_21.html" aria-current="page">L25</a>
          <a href="lecture_22.html">L26</a>
          <a href="lecture_23.html">L27</a>
          <a href="lecture_24.html">L28</a>
          <a href="lecture_25.html" aria-current="page">L29</a>
          <a href="lecture_26.html">L30</a>
        </nav>
      </div>
<head>
  <meta charset="utf-8">
  <title>Lecture 24 — Decision Trees in Machine Learning</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    :root{
      --bg:#f6f8fb; --card:#ffffff; --muted:#6b7280; --accent:#0ea5e9; --accent-2:#059669;
      --title:#0b2447; --glass: rgba(255,255,255,0.6);
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,#f3f6fb 0%, #eef3f9 100%); color:#111827;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    .wrap{max-width:1100px;margin:28px auto;padding:22px;}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px;}
    header h1{margin:0;font-size:1.4rem;color:var(--title);letter-spacing:-0.2px}
    nav a{color:var(--accent);text-decoration:none;font-size:0.95rem;margin-left:12px}
    main{display:grid;grid-template-columns: 1fr 320px;gap:20px;}
    @media (max-width:980px){ main{grid-template-columns:1fr; } .aside{order:2} }
    .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 6px 20px rgba(15,23,42,0.06);border:1px solid rgba(15,23,42,0.04)}
    .section-title{color:var(--accent);margin-top:0}
    h2{margin:0 0 10px 0;font-size:1.05rem;color:var(--title)}
    p{color:#374151;margin:0 0 10px 0}
    ul{margin:8px 0 14px 20px;color:#374151}
    .pill{display:inline-block;background:var(--glass);padding:6px 10px;border-radius:999px;font-size:0.82rem;color:var(--muted);border:1px solid rgba(15,23,42,0.03);margin-right:6px}
    pre{background:#0b1220;color:#e6eefc;padding:12px;border-radius:8px;overflow:auto;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;font-size:0.87rem}
    code{background:#eef2ff;padding:2px 6px;border-radius:6px;font-size:0.9rem}
    .example{border-left:4px solid var(--accent);padding:10px 14px;background:linear-gradient(90deg,#f8fcff, #ffffff);border-radius:8px;margin:10px 0}
    .muted{color:var(--muted);font-size:0.92rem}
    .models{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:10px}
    @media(max-width:760px){ .models{grid-template-columns:1fr} }
    .model{padding:12px;border-radius:8px;border:1px solid rgba(9,30,66,0.04);background:#fff}
    .calculator{margin-top:14px;padding:14px;border-radius:10px;border:1px dashed rgba(0,0,0,0.06);background:linear-gradient(180deg,#fbfffd,#f7fff9)}
    label{display:block;margin:8px 0 6px;font-weight:600;color:#0f172a;font-size:0.92rem}
    input[type="number"], select{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(15,23,42,0.08);font-size:0.95rem}
    button{display:inline-block;padding:10px 14px;border-radius:8px;border:0;background:var(--accent);color:white;font-weight:600;cursor:pointer;margin-top:10px}
    button.secondary{background:var(--accent-2);margin-left:8px}
    footer{margin-top:18px;color:var(--muted);font-size:0.92rem;text-align:center}
    .toc{font-size:0.95rem}
    .toc a{display:block;color:var(--accent);text-decoration:none;margin-bottom:6px}
    .small-note{font-size:0.9rem;color:var(--muted);margin-top:8px}
    .result{margin-top:10px;padding:10px;border-radius:8px;background:#0f172a;color:#fff}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Lecture 24 — Decision Trees</h1>
        <div class="small-note">Theory • Algorithms • Examples • Interactive demo</div>
      </div>
      <nav>
        <a href="#theory">Theory</a>
        <a href="#models">Models</a>
        <a href="#example">Example</a>
        <a href="#calculator">Calculator</a>
      </nav>
    </header>

    <main>
      <!-- Main content -->
      <section class="card">
        <h2 id="theory" class="section-title">1. What is a Decision Tree?</h2>
        <p>
          A <strong>Decision Tree</strong> is a tree-structured predictive model that maps features (decisions) to outcomes.
          Internal nodes test feature values, branches represent test outcomes, and leaves give final predictions (class label or real value).
        </p>

        <div class="example">
          <strong>Intuition:</strong> Think of answering a sequence of yes/no questions that narrow down to a decision:
          e.g., "Is credit score &ge; 700?" → "Is monthly income &ge; 50,000?" → then approve or reject a loan.
        </div>

        <h2 id="models" class="section-title">2. Key Concepts & Splitting Criteria</h2>
        <ul>
          <li><strong>Entropy</strong> (information theory): measures class impurity: <code>H(S) = − Σ pᵢ log₂ pᵢ</code>.</li>
          <li><strong>Information Gain</strong>: expected reduction in entropy when splitting on a feature.</li>
          <li><strong>Gini Index</strong>: alternative impurity metric used by CART: <code>G = 1 − Σ pᵢ²</code>.</li>
          <li><strong>Gain Ratio</strong>: used by C4.5 to counter bias toward features with many values.</li>
        </ul>

        <h3 class="section-title">3. Advantages & Disadvantages</h3>
        <div class="models" style="margin-bottom:8px">
          <div class="model"><strong>Pros</strong><ul><li>Interpretable rules</li><li>Handles mixed data types</li><li>No scaling required</li></ul></div>
          <div class="model"><strong>Cons</strong><ul><li>High variance (prone to overfitting)</li><li>Unstable small changes in data</li><li>Greedy splits may be suboptimal</li></ul></div>
        </div>

        <h2 class="section-title">4. Six Tree-Related Models / Methods</h2>
        <div class="models">
          <div class="model">
            <h4>ID3</h4>
            <p>Early algorithm using Information Gain for splits. Works best with categorical features.</p>
          </div>
          <div class="model">
            <h4>C4.5</h4>
            <p>Extension of ID3: handles continuous attributes, missing values, and performs pruning.</p>
          </div>
          <div class="model">
            <h4>CART</h4>
            <p>Classification And Regression Trees: uses Gini impurity; supports regression and classification.</p>
          </div>
          <div class="model">
            <h4>Random Forest</h4>
            <p>Ensemble of many trees (bagging + random feature subset) — reduces variance significantly.</p>
          </div>
          <div class="model">
            <h4>Gradient Boosted Trees (e.g., XGBoost)</h4>
            <p>Sequentially builds trees to correct previous errors (boosting). High predictive power on tabular data.</p>
          </div>
          <div class="model">
            <h4>Extra Trees / Extremely Randomized Trees</h4>
            <p>Introduce more randomness in split selection for variance reduction and speed.</p>
          </div>
        </div>

        <h2 id="example" class="section-title">5. Worked Example — "Play Tennis" (toy)</h2>
        <p class="muted">We use a tiny dataset to illustrate choosing a split via entropy / information gain.</p>

        <pre><code>
Dataset (Play Tennis?)
Outlook   Temp   Humidity  Windy   Play
Sunny     Hot    High      False   No
Sunny     Hot    High      True    No
Overcast  Hot    High      False   Yes
Rainy     Mild   High      False   Yes
Rainy     Cool   Normal    False   Yes
Rainy     Cool   Normal    True    No
Overcast  Cool   Normal    True    Yes
Sunny     Mild   High      False   No
Sunny     Cool   Normal    False   Yes
Rainy     Mild   Normal    False   Yes
...
(Compute entropy of Play; split on Outlook; compute weighted entropies for branches)
        </code></pre>

        <p>
          Typically, we compute <em>Entropy(Play)</em>, then for each feature (e.g., Outlook) compute the weighted average entropy of child nodes,
          and select the feature with maximum <strong>Information Gain</strong>.
        </p>

        <h2 class="section-title">6. Practical Tips</h2>
        <ul>
          <li><strong>Prune</strong> trees (pre- or post-pruning) to reduce overfitting.</li>
          <li>Limit <code>max_depth</code>, set <code>min_samples_leaf</code>.</li>
          <li>Use ensembles (Random Forest, Gradient Boosting) for better accuracy on real problems.</li>
          <li>Visualize trees for interpretability (plot with feature names).</li>
        </ul>

        <h2 class="section-title">7. Example Code (scikit-learn)</h2>
        <pre><code>from sklearn.tree import DecisionTreeClassifier
clf = DecisionTreeClassifier(criterion='entropy', max_depth=4, random_state=0)
clf.fit(X_train, y_train)

# visualize
from sklearn.tree import plot_tree
plot_tree(clf, feature_names=features, class_names=classes, filled=True)
        </code></pre>

        <p class="muted">Tip: For production, evaluate with cross-validation and consider class imbalance adjustments.</p>

      </section>

      <!-- Aside / calculator -->
      <aside class="card aside">
        <h3 class="section-title">On this page</h3>
        <div class="toc">
          <a href="#theory">Theory</a>
          <a href="#models">Models</a>
          <a href="#example">Worked Example</a>
          <a href="#calculator">Calculator</a>
        </div>

        <hr style="border:none;border-top:1px solid #eef2f7;margin:12px 0">

        <h3 class="section-title">Loan Approval — Simple Decision Rules</h3>
        <p class="muted">A tiny interactive demo to show how a decision-tree-like rule works.</p>

        <div class="calculator" id="calculator">
          <label for="income">Monthly Income (USD)</label>
          <input id="income" type="number" min="0" placeholder="e.g., 60000">

          <label for="score">Credit Score</label>
          <input id="score" type="number" min="0" max="1000" placeholder="e.g., 720">

          <label for="existing">Existing Loans</label>
          <select id="existing">
            <option value="no">No</option>
            <option value="yes">Yes</option>
          </select>

          <label for="employment">Employment Years</label>
          <input id="employment" type="number" min="0" placeholder="e.g., 3">

          <button onclick="evaluateLoan()">Check Decision</button>
          <button class="secondary" onclick="explainDecision()">Explain</button>

          <div id="decisionResult" class="result" style="display:none"></div>
          <div id="explainBox" style="display:none;margin-top:10px;padding:10px;border-radius:8px;background:#fff;border:1px solid rgba(0,0,0,0.04)"></div>
        </div>

        <p class="small-note">This is an educational demo — real lending models are far more complex and regulated.</p>
      </aside>
    </main>

    <footer class="card" style="margin-top:18px">
      <h3 style="margin:0 0 8px 0">Further reading & next steps</h3>
      <ul>
        <li>Implement CART and visualize splits.</li>
        <li>Try Random Forest & compare OOB (out-of-bag) error.</li>
        <li>Explore boosting libraries: XGBoost, LightGBM, CatBoost.</li>
      </ul>
    </footer>
  </div>

  <script>
    // Simple decision-tree-like rules for demo purposes
    function evaluateLoan() {
      const income = Number(document.getElementById('income').value || 0);
      const score = Number(document.getElementById('score').value || 0);
      const existing = document.getElementById('existing').value;
      const employment = Number(document.getElementById('employment').value || 0);

      // Basic rule set (toy rules)
      // Rule flow:
      // if credit score >= 750 -> approve if income >= 30000 or employment >=2
      // else if score between 650-749 -> approve if income>=50000 and no existing loans
      // else reject
      let decision = "Not Approved";
      let reasons = [];

      if (score >= 750) {
        if (income >= 30000 || employment >= 2) {
          decision = "Approved";
          reasons.push("High credit score (≥750) and sufficient income or employment history.");
        } else {
          decision = "Manual Review";
          reasons.push("High credit score but low income and short employment; recommend manual review.");
        }
      } else if (score >= 650 && score < 750) {
        if (income >= 50000 && existing === "no") {
          decision = "Approved";
          reasons.push("Moderate credit score with high income and no existing loans.");
        } else {
          decision = "Not Approved";
          reasons.push("Moderate credit score but income or existing loans not favorable.");
        }
      } else {
        decision = "Not Approved";
        reasons.push("Low credit score (<650).");
      }

      // small penalty for existing loans
      if (existing === "yes" && decision === "Approved") {
        decision = "Approved (with conditions)";
        reasons.push("Existing loans present — approval conditional on debt-to-income evaluation.");
      }

      const resultBox = document.getElementById('decisionResult');
      resultBox.style.display = "block";
      resultBox.innerHTML = "<strong>Decision:</strong> " + decision + "<br><span style='font-size:0.95rem;color:#d1fae5'>Reason(s):</span><br>" + reasons.map(r => "• " + r).join("<br>");
      document.getElementById('explainBox').style.display = "none";
    }

    function explainDecision() {
      // Provide an explanation template showing the "path"
      const income = Number(document.getElementById('income').value || 0);
      const score = Number(document.getElementById('score').value || 0);
      const existing = document.getElementById('existing').value;
      const employment = Number(document.getElementById('employment').value || 0);

      let path = [];

      if (score >= 750) {
        path.push("Node 1: credit_score >= 750 -> TRUE");
        if (income >= 30000 || employment >= 2) {
          path.push("Node 2: (income >= 30000) OR (employment >= 2) -> TRUE -> Leaf: Approve");
        } else {
          path.push("Node 2: (income >= 30000) OR (employment >= 2) -> FALSE -> Leaf: Manual Review");
        }
      } else if (score >= 650) {
        path.push("Node 1: credit_score >= 750 -> FALSE");
        path.push("Node 2: credit_score >= 650 -> TRUE");
        if (income >= 50000 && existing === "no") {
          path.push("Node 3: income >= 50000 AND existing_loans == no -> TRUE -> Leaf: Approve");
        } else {
          path.push("Node 3: income >= 50000 AND existing_loans == no -> FALSE -> Leaf: Not Approved");
        }
      } else {
        path.push("Node 1: credit_score >= 750 -> FALSE");
        path.push("Node 2: credit_score >= 650 -> FALSE -> Leaf: Not Approved");
      }

      const explainBox = document.getElementById('explainBox');
      explainBox.style.display = "block";
      explainBox.innerHTML = "<strong>Decision Path (simulated tree):</strong><br><ol>" + path.map(p => "<li style='margin:6px 0'>" + p + "</li>").join("") + "</ol>";
      document.getElementById('decisionResult').style.display = "none";
    }

    // small UX: press Enter in inputs triggers evaluate
    ['income','score','employment'].forEach(id => {
      document.getElementById(id).addEventListener('keydown', function(e){
        if(e.key === 'Enter'){ evaluateLoan(); }
      });
    });
  </script>
</body>
</html>
